<!DOCTYPE html>
<html>
    <script>
        
        const computerPlay = () => {
            const selectionNumber = Math.floor(Math.random() * 3)
            let selection
            
            if (selectionNumber === 1) {
                selection = "rock"
            } else if (selectionNumber === 2) {
                selection = "paper"
            } else {
                selection = "scissors"
            }

            return selection
        }

        const playRound = (playerSelection, computerSelection) => {

            playerSelection = playerSelection.toLowerCase()

            if (!((playerSelection == "rock") || (playerSelection == "paper") || (playerSelection == "scissors" ))) {
                playerSelection = window.prompt("Incorrect choice! Please choose either rock, paper or scissors.")
                playRound( playerSelection, computerSelection)
            }

            let result
            let winner = null

            switch(true) {
                case (playerSelection === "rock" && computerSelection === "scissors"):
                    result = "You win! Rock beats scissors"
                    winner = "player"
                    break;
                case (playerSelection === "rock" && computerSelection === "rock"):
                    result = "Draw! Both have Rock"
                    break;
                case (playerSelection === "rock" && computerSelection === "paper"):
                    result = "You lose! Paper beats Rock"
                    winner = "computer"
                    break;
                case (playerSelection === "paper" && computerSelection === "scissors"):
                    result = "You lose! Scissors beats Paper"
                    winner = "computer"
                    break;
                case (playerSelection === "paper" && computerSelection === "paper"):
                    result = "Draw! Both have paper"
                    break;
                case (playerSelection === "paper" && computerSelection === "rock"):
                    result = "You win! Paper beats rock"
                    winner = "player"
                    break;
                case (playerSelection === "scissors" && computerSelection === "scissors"):
                    result = "Draw! Both have scissors"
                    break;
                case (playerSelection === "scissors" && computerSelection === "paper"):
                    result = "You win! Scissors beat paper"
                    winner = "scissors"
                    break;
                case (playerSelection === "scissors" && computerSelection === "rock"):
                    result = "You lose! Rock beats scissors"
                    winner = "computer"
                    break;
            }

            return winner
        }  

        alert("Welcome to the game of rock, paper and scissors!")

        const game = () => {

            const rounds = window.prompt("How many rounds would you like to play?")

            if ( rounds < 1 || isNaN(rounds)) {
                alert("Please enter a number higher than 0!")
                game()
            }

            let computerScore = 0
            let playerScore = 0

            let numberRounds = rounds - (rounds -1) 

            let winner

            // Updating scores
            const scores = () => {
                if (winner === "player") {
                    playerScore ++
                    alert(`Player wins round ${numberRounds}`)
                } else if (winner === "computer") {
                    computerScore ++
                    alert(`Computer wins round ${numberRounds}`)
                } else {
                    alert(`Round ${numberRounds} is a draw`)
                }
                numberRounds++
            }

            let playerChoice

            // Looping rounds
            for (i=0; i < rounds; i++) {
                playerChoice = window.prompt("Rock, paper or scissors?")

                winner = playRound(playerChoice, computerPlay())
                scores()
            }

            //Declaring winner
            if ( computerScore > playerScore) {
                alert("Game has finished! Computer wins the game!")
            } else if (playerScore > computerScore) {
                alert("Game has finished! Player wins the game!")
            } else {
                alert("Game has finished! It's a draw")
            }
        }
    
        game()


    </script>

</html>